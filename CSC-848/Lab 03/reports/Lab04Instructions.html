<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_list_1-0{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-0.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-0 0}.lst-kix_j4hdgm5oifhe-8>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-8}ul.lst-kix_list_1-3{list-style-type:none}ul.lst-kix_list_1-4{list-style-type:none}ul.lst-kix_list_1-1{list-style-type:none}ul.lst-kix_list_1-2{list-style-type:none}ul.lst-kix_list_1-7{list-style-type:none}.lst-kix_bf42l0fe1gjo-8>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-8}ul.lst-kix_list_1-8{list-style-type:none}ul.lst-kix_list_1-5{list-style-type:none}ul.lst-kix_list_1-6{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-6.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-6 0}ul.lst-kix_4rxkyl6ur9yk-5{list-style-type:none}ul.lst-kix_4rxkyl6ur9yk-6{list-style-type:none}ul.lst-kix_4rxkyl6ur9yk-7{list-style-type:none}ul.lst-kix_4rxkyl6ur9yk-8{list-style-type:none}.lst-kix_9rpv6g36kjq6-8>li:before{content:"\0025a0  "}.lst-kix_lylj026qntmg-7>li:before{content:"\0025cb  "}.lst-kix_lylj026qntmg-8>li:before{content:"\0025a0  "}.lst-kix_list_5-0>li:before{content:"\0025cf  "}.lst-kix_9rpv6g36kjq6-7>li:before{content:"\0025cb  "}.lst-kix_9rpv6g36kjq6-6>li:before{content:"\0025cf  "}.lst-kix_lylj026qntmg-5>li:before{content:"\0025a0  "}.lst-kix_lylj026qntmg-6>li:before{content:"\0025cf  "}.lst-kix_list_5-3>li:before{content:"\0025cf  "}.lst-kix_9rpv6g36kjq6-4>li:before{content:"\0025cb  "}ul.lst-kix_4rxkyl6ur9yk-1{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-6{list-style-type:none}.lst-kix_lylj026qntmg-3>li:before{content:"\0025cf  "}.lst-kix_lylj026qntmg-4>li:before{content:"\0025cb  "}ul.lst-kix_4rxkyl6ur9yk-2{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-7{list-style-type:none}.lst-kix_list_5-2>li:before{content:"\0025aa  "}.lst-kix_9rpv6g36kjq6-3>li:before{content:"\0025cf  "}.lst-kix_9rpv6g36kjq6-5>li:before{content:"\0025a0  "}ul.lst-kix_4rxkyl6ur9yk-3{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-4{list-style-type:none}ul.lst-kix_4rxkyl6ur9yk-4{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-5{list-style-type:none}.lst-kix_list_5-1>li:before{content:"o  "}ul.lst-kix_ywvsghwlkh3b-8{list-style-type:none}.lst-kix_bf42l0fe1gjo-4>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-4}ul.lst-kix_4rxkyl6ur9yk-0{list-style-type:none}.lst-kix_list_5-7>li:before{content:"o  "}.lst-kix_lylj026qntmg-0>li:before{content:"\0025cf  "}.lst-kix_list_5-6>li:before{content:"\0025cf  "}.lst-kix_list_5-8>li:before{content:"\0025aa  "}.lst-kix_lylj026qntmg-1>li:before{content:"\0025cb  "}.lst-kix_lylj026qntmg-2>li:before{content:"\0025a0  "}ol.lst-kix_bf42l0fe1gjo-5.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-5 0}.lst-kix_list_5-4>li:before{content:"o  "}.lst-kix_list_5-5>li:before{content:"\0025aa  "}.lst-kix_j4hdgm5oifhe-6>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-6}.lst-kix_9rpv6g36kjq6-0>li:before{content:"\0025cf  "}.lst-kix_9rpv6g36kjq6-1>li:before{content:"\0025cb  "}.lst-kix_9rpv6g36kjq6-2>li:before{content:"\0025a0  "}ul.lst-kix_ywvsghwlkh3b-2{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-3{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-0{list-style-type:none}ul.lst-kix_ywvsghwlkh3b-1{list-style-type:none}.lst-kix_list_2-7>li:before{content:"o  "}.lst-kix_bf42l0fe1gjo-3>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-3,decimal) ". "}.lst-kix_bf42l0fe1gjo-1>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-1}.lst-kix_list_2-5>li:before{content:"\0025aa  "}.lst-kix_bf42l0fe1gjo-7>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-7,lower-latin) ". "}.lst-kix_bf42l0fe1gjo-5>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-5,lower-roman) ". "}.lst-kix_j4hdgm5oifhe-2>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-2}ol.lst-kix_j4hdgm5oifhe-2.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-2 0}ul.lst-kix_list_3-7{list-style-type:none}ul.lst-kix_list_3-8{list-style-type:none}ul.lst-kix_list_3-1{list-style-type:none}.lst-kix_j4hdgm5oifhe-3>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-3}ul.lst-kix_list_3-2{list-style-type:none}ul.lst-kix_list_3-0{list-style-type:none}ul.lst-kix_ki225zhlwdkt-8{list-style-type:none}ul.lst-kix_list_3-5{list-style-type:none}ul.lst-kix_ki225zhlwdkt-7{list-style-type:none}ul.lst-kix_list_3-6{list-style-type:none}ul.lst-kix_ki225zhlwdkt-6{list-style-type:none}.lst-kix_bf42l0fe1gjo-1>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-1,lower-latin) ". "}ul.lst-kix_list_3-3{list-style-type:none}ul.lst-kix_ki225zhlwdkt-5{list-style-type:none}ul.lst-kix_list_3-4{list-style-type:none}ul.lst-kix_ki225zhlwdkt-4{list-style-type:none}ul.lst-kix_ki225zhlwdkt-3{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-5.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-5 0}ul.lst-kix_ki225zhlwdkt-2{list-style-type:none}.lst-kix_ywvsghwlkh3b-6>li:before{content:"\0025cf  "}ul.lst-kix_ki225zhlwdkt-1{list-style-type:none}.lst-kix_j4hdgm5oifhe-0>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-0,decimal) ". "}ul.lst-kix_ki225zhlwdkt-0{list-style-type:none}.lst-kix_ywvsghwlkh3b-2>li:before{content:"\0025a0  "}.lst-kix_list_4-1>li:before{content:"o  "}.lst-kix_j4hdgm5oifhe-2>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-2,lower-roman) ". "}.lst-kix_j4hdgm5oifhe-4>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-4,lower-latin) ". "}.lst-kix_ywvsghwlkh3b-0>li:before{content:"\0025cf  "}.lst-kix_ywvsghwlkh3b-8>li:before{content:"\0025a0  "}.lst-kix_list_4-3>li:before{content:"\0025cf  "}.lst-kix_list_4-5>li:before{content:"\0025aa  "}.lst-kix_j4hdgm5oifhe-1>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-1}.lst-kix_ywvsghwlkh3b-4>li:before{content:"\0025cb  "}.lst-kix_4rxkyl6ur9yk-2>li:before{content:"\0025a0  "}.lst-kix_4rxkyl6ur9yk-0>li:before{content:"\0025cf  "}.lst-kix_4rxkyl6ur9yk-4>li:before{content:"\0025cb  "}.lst-kix_4rxkyl6ur9yk-6>li:before{content:"\0025cf  "}ul.lst-kix_list_2-8{list-style-type:none}.lst-kix_j4hdgm5oifhe-6>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-6,decimal) ". "}.lst-kix_j4hdgm5oifhe-8>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-8,lower-roman) ". "}ul.lst-kix_list_2-2{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-2.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-2 0}ul.lst-kix_list_2-3{list-style-type:none}ul.lst-kix_list_2-0{list-style-type:none}ul.lst-kix_list_2-1{list-style-type:none}ul.lst-kix_list_2-6{list-style-type:none}.lst-kix_list_1-1>li:before{content:"o  "}ul.lst-kix_list_2-7{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-4.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-4 0}ul.lst-kix_list_2-4{list-style-type:none}ul.lst-kix_list_2-5{list-style-type:none}.lst-kix_list_1-3>li:before{content:"\0025cf  "}.lst-kix_list_1-7>li:before{content:"o  "}.lst-kix_list_1-5>li:before{content:"\0025aa  "}.lst-kix_list_2-1>li:before{content:"o  "}ol.lst-kix_j4hdgm5oifhe-3.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-3 0}.lst-kix_4rxkyl6ur9yk-8>li:before{content:"\0025a0  "}.lst-kix_bf42l0fe1gjo-6>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-6}.lst-kix_list_2-3>li:before{content:"\0025cf  "}.lst-kix_bf42l0fe1gjo-0>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-0}ol.lst-kix_bf42l0fe1gjo-1.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-1 0}ol.lst-kix_j4hdgm5oifhe-6.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-6 0}.lst-kix_bf42l0fe1gjo-7>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-7}.lst-kix_list_3-0>li:before{content:"\0025cf  "}ul.lst-kix_list_5-7{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-6{list-style-type:none}ul.lst-kix_list_5-8{list-style-type:none}.lst-kix_list_3-1>li:before{content:"\0025cb  "}.lst-kix_list_3-2>li:before{content:"\0025a0  "}ol.lst-kix_j4hdgm5oifhe-5{list-style-type:none}ul.lst-kix_list_5-5{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-4{list-style-type:none}ul.lst-kix_list_5-6{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-3{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-2{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-1{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-0{list-style-type:none}.lst-kix_list_3-5>li:before{content:"\0025a0  "}ul.lst-kix_list_5-0{list-style-type:none}.lst-kix_list_3-4>li:before{content:"\0025cb  "}ul.lst-kix_list_5-3{list-style-type:none}.lst-kix_list_3-3>li:before{content:"\0025cf  "}ul.lst-kix_list_5-4{list-style-type:none}ul.lst-kix_list_5-1{list-style-type:none}ul.lst-kix_list_5-2{list-style-type:none}.lst-kix_list_3-8>li:before{content:"\0025a0  "}ol.lst-kix_bf42l0fe1gjo-2{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-1{list-style-type:none}.lst-kix_list_3-6>li:before{content:"\0025cf  "}ol.lst-kix_bf42l0fe1gjo-0{list-style-type:none}.lst-kix_list_3-7>li:before{content:"\0025cb  "}ol.lst-kix_bf42l0fe1gjo-6{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-3.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-3 0}ol.lst-kix_bf42l0fe1gjo-5{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-4{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-3{list-style-type:none}.lst-kix_j4hdgm5oifhe-7>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-7}.lst-kix_ki225zhlwdkt-4>li:before{content:"\0025cb  "}.lst-kix_ki225zhlwdkt-5>li:before{content:"\0025a0  "}.lst-kix_ki225zhlwdkt-2>li:before{content:"\0025a0  "}.lst-kix_ki225zhlwdkt-6>li:before{content:"\0025cf  "}.lst-kix_list_4-8>li:before{content:"\0025aa  "}.lst-kix_ki225zhlwdkt-0>li:before{content:"\0025cf  "}.lst-kix_ki225zhlwdkt-1>li:before{content:"\0025cb  "}.lst-kix_ki225zhlwdkt-8>li:before{content:"\0025a0  "}.lst-kix_list_4-7>li:before{content:"o  "}.lst-kix_ki225zhlwdkt-7>li:before{content:"\0025cb  "}ul.lst-kix_list_4-8{list-style-type:none}ul.lst-kix_list_4-6{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-8{list-style-type:none}ul.lst-kix_list_4-7{list-style-type:none}ol.lst-kix_bf42l0fe1gjo-7{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-1.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-1 0}.lst-kix_j4hdgm5oifhe-0>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-0}ul.lst-kix_list_4-0{list-style-type:none}ul.lst-kix_list_4-1{list-style-type:none}.lst-kix_bf42l0fe1gjo-5>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-5}ul.lst-kix_list_4-4{list-style-type:none}ul.lst-kix_list_4-5{list-style-type:none}.lst-kix_ki225zhlwdkt-3>li:before{content:"\0025cf  "}ul.lst-kix_list_4-2{list-style-type:none}ul.lst-kix_list_4-3{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-7.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-7 0}ol.lst-kix_bf42l0fe1gjo-4.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-4 0}ol.lst-kix_j4hdgm5oifhe-0.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-0 0}.lst-kix_list_2-6>li:before{content:"\0025cf  "}.lst-kix_bf42l0fe1gjo-4>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-4,lower-latin) ". "}ol.lst-kix_bf42l0fe1gjo-7.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-7 0}.lst-kix_list_2-4>li:before{content:"o  "}.lst-kix_list_2-8>li:before{content:"\0025aa  "}.lst-kix_bf42l0fe1gjo-6>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-6,decimal) ". "}.lst-kix_bf42l0fe1gjo-0>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-0,decimal) ". "}.lst-kix_bf42l0fe1gjo-2>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-2,lower-roman) ". "}.lst-kix_ywvsghwlkh3b-7>li:before{content:"\0025cb  "}ul.lst-kix_9rpv6g36kjq6-1{list-style-type:none}ul.lst-kix_9rpv6g36kjq6-0{list-style-type:none}.lst-kix_j4hdgm5oifhe-1>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-1,lower-latin) ". "}.lst-kix_bf42l0fe1gjo-2>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-2}.lst-kix_list_4-0>li:before{content:"\0025cf  "}ul.lst-kix_9rpv6g36kjq6-3{list-style-type:none}ul.lst-kix_9rpv6g36kjq6-2{list-style-type:none}ul.lst-kix_9rpv6g36kjq6-5{list-style-type:none}ul.lst-kix_9rpv6g36kjq6-4{list-style-type:none}ul.lst-kix_9rpv6g36kjq6-7{list-style-type:none}ul.lst-kix_9rpv6g36kjq6-6{list-style-type:none}.lst-kix_ywvsghwlkh3b-1>li:before{content:"\0025cb  "}ul.lst-kix_9rpv6g36kjq6-8{list-style-type:none}.lst-kix_j4hdgm5oifhe-3>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-3,decimal) ". "}.lst-kix_list_4-4>li:before{content:"o  "}ol.lst-kix_j4hdgm5oifhe-8.start{counter-reset:lst-ctn-kix_j4hdgm5oifhe-8 0}.lst-kix_list_4-2>li:before{content:"\0025aa  "}.lst-kix_list_4-6>li:before{content:"\0025cf  "}.lst-kix_j4hdgm5oifhe-4>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-4}ul.lst-kix_lylj026qntmg-0{list-style-type:none}ul.lst-kix_lylj026qntmg-1{list-style-type:none}ul.lst-kix_lylj026qntmg-2{list-style-type:none}.lst-kix_bf42l0fe1gjo-8>li:before{content:"" counter(lst-ctn-kix_bf42l0fe1gjo-8,lower-roman) ". "}.lst-kix_ywvsghwlkh3b-3>li:before{content:"\0025cf  "}ul.lst-kix_lylj026qntmg-3{list-style-type:none}ul.lst-kix_lylj026qntmg-4{list-style-type:none}ul.lst-kix_lylj026qntmg-5{list-style-type:none}ul.lst-kix_lylj026qntmg-6{list-style-type:none}.lst-kix_ywvsghwlkh3b-5>li:before{content:"\0025a0  "}ul.lst-kix_lylj026qntmg-7{list-style-type:none}ul.lst-kix_lylj026qntmg-8{list-style-type:none}.lst-kix_4rxkyl6ur9yk-1>li:before{content:"\0025cb  "}.lst-kix_j4hdgm5oifhe-5>li{counter-increment:lst-ctn-kix_j4hdgm5oifhe-5}.lst-kix_4rxkyl6ur9yk-5>li:before{content:"\0025a0  "}.lst-kix_4rxkyl6ur9yk-7>li:before{content:"\0025cb  "}.lst-kix_j4hdgm5oifhe-5>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-5,lower-roman) ". "}.lst-kix_list_1-0>li:before{content:"\0025cf  "}.lst-kix_list_1-2>li:before{content:"\0025aa  "}.lst-kix_4rxkyl6ur9yk-3>li:before{content:"\0025cf  "}.lst-kix_j4hdgm5oifhe-7>li:before{content:"" counter(lst-ctn-kix_j4hdgm5oifhe-7,lower-latin) ". "}.lst-kix_list_1-4>li:before{content:"o  "}ol.lst-kix_bf42l0fe1gjo-8.start{counter-reset:lst-ctn-kix_bf42l0fe1gjo-8 0}.lst-kix_list_1-6>li:before{content:"\0025cf  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_j4hdgm5oifhe-8{list-style-type:none}ol.lst-kix_j4hdgm5oifhe-7{list-style-type:none}.lst-kix_bf42l0fe1gjo-3>li{counter-increment:lst-ctn-kix_bf42l0fe1gjo-3}.lst-kix_list_2-0>li:before{content:"\0025cf  "}.lst-kix_list_1-8>li:before{content:"\0025aa  "}.lst-kix_list_2-2>li:before{content:"\0025aa  "}ol{margin:0;padding:0}table td,table th{padding:0}.c0{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:left}.c14{padding-top:0pt;padding-bottom:3pt;line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:left;height:11pt}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c13{padding-top:0pt;padding-bottom:0pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:center}.c12{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c16{padding-top:0pt;padding-bottom:0pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:right}.c6{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:left}.c8{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c15{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c1{padding:0;margin:0}.c9{color:inherit;text-decoration:inherit}.c7{margin-left:108pt;padding-left:0pt}.c11{margin-left:72pt;padding-left:0pt}.c10{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.1500000000000001;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c15"><div><p class="c4"><span class="c2">CSC-848 Advanced Software Exploitation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flack, Micah</span></p></div><p class="c14 title" id="h.gjdgxs"><span class="c5">Lab 03 &ndash; ROP with WAVreader</span></p><hr><p class="c3"><span class="c2"></span></p><p class="c3"><span class="c10 c12"></span></p><p class="c4"><span class="c10">Note: I should have noticed earlier&hellip; but I&rsquo;ve been using my own Win7 environment because the Ialab is too laggy for me. Any scripts I submit from now on will be tailored to limit any obstacles created by the &ldquo;different&rdquo; environments.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Starting the program and just doing the basics of seeing how everything flows from execution to termination&hellip; and with a valid .WAV file it doesn&rsquo;t work? I&rsquo;ll dig into this later with a disassembler.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 46.67px;"><img alt="" src="images/image13.png" style="width: 624.00px; height: 46.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Presumably, whatever implementation this is doesn&rsquo;t follow the file standards for .WAV. For reference, this is what the file structure should look like:</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c8"><a class="c9" href="https://www.google.com/url?q=http://www-mmsp.ece.mcgill.ca/Documents/AudioFormats/WAVE/WAVE.html&amp;sa=D&amp;source=editors&amp;ust=1645239555626940&amp;usg=AOvVaw0kRv4XJWEoRl1A4uYY_PgT">http://www-mmsp.ece.mcgill.ca/Documents/AudioFormats/WAVE/WAVE.html</a></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c8"><a class="c9" href="https://www.google.com/url?q=https://github.com/cr/a1541/blob/2f8c5f1b6b90403d811387c42da6f3ad76057d27/doc/formats/WAV.TXT&amp;sa=D&amp;source=editors&amp;ust=1645239555627536&amp;usg=AOvVaw22T-Cp6Vc5BPnViMJGKB3L">https://github.com/cr/a1541/blob/2f8c5f1b6b90403d811387c42da6f3ad76057d27/doc/formats/WAV.TXT</a></span><span>&nbsp;</span></p><p class="c3"><span class="c2"></span></p><p class="c13"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 2.67px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 392.97px; height: 375.50px;"><img alt="" src="images/image16.png" style="width: 392.97px; height: 375.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">I have a very strong hunch that the above formatting info will be important later on&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Jumping through the program&hellip; We go from entry() to the exit calls&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 352.50px; height: 178.95px;"><img alt="" src="images/image19.png" style="width: 352.50px; height: 178.95px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">See the exit() call above&hellip; Then just look for the instructions for MOV XXX, EAX immediately succeeding a call to somewhere else unlabeled in the program.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 456.50px; height: 96.89px;"><img alt="" src="images/image18.png" style="width: 456.50px; height: 96.89px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Here we have main() - we know this is it because we see xrefs to strings shown during runtime</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 551.50px; height: 241.28px;"><img alt="" src="images/image6.png" style="width: 551.50px; height: 241.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">At this point I really just want to see why our properly formatted .WAV file fails to read and returns the output &lsquo;Invalid Format.&rsquo; - I know I have interpreted the instructions for this executable correctly, so this is the first step towards understanding core functionality.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Without getting to nitty gritty into the details - some key logic/calls we see in main() are:</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 345.00px; height: 24.00px;"><img alt="" src="images/image1.png" style="width: 345.00px; height: 24.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 177.00px; height: 22.00px;"><img alt="" src="images/image12.png" style="width: 177.00px; height: 22.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;== &lsquo;NULL&rsquo;</span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 254.00px; height: 23.00px;"><img alt="" src="images/image7.png" style="width: 254.00px; height: 23.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">And then the code block that is most interesting is here&hellip; If you walk through the majority of main() it is just making sure that the correct number of args is provided, or that you&rsquo;re not asking for &lsquo;help&rsquo;. </span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 554.50px; height: 224.80px;"><img alt="" src="images/image26.png" style="width: 554.50px; height: 224.80px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">The first call to _strcpy is retrieving the contents of the provided &lsquo;command.txt&rsquo; - at this moment, the contents are just &lsquo;test&rsquo;.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">However, I am most interested in the FUN_004018e0 because this is where the text for our error is generated. We should also note that it reads the contents of the provided wave file before making the call through _strcpy(param_2 + 4).</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Using x32dbg we set the breakpoints and then run until breaked&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 627.90px; height: 80.50px;"><img alt="" src="images/image8.png" style="width: 627.90px; height: 80.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Referring back to Ghidra&hellip; if we look at the FUN_004018e0 we should see some references to the file format structure for .WAV.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 560.00px; height: 128.00px;"><img alt="" src="images/image15.png" style="width: 560.00px; height: 128.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">So pretty obvious it is checking the first 3-4 fields represented in the WAV file format.</span></p><ul class="c1 lst-kix_lylj026qntmg-0 start"><li class="c0 li-bullet-0"><span class="c2">ChunkID: RIFF</span></li><li class="c0 li-bullet-0"><span class="c2">[Skipped] ChunkSize</span></li><li class="c0 li-bullet-0"><span class="c2">WaveID: WAVE</span></li><li class="c0 li-bullet-0"><span class="c2">ChunkID: fmt</span></li><li class="c0 li-bullet-0"><span class="c2">[Skipped] ChunkSize</span></li><li class="c0 li-bullet-0"><span class="c2">ChunkID: data</span></li></ul><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">This buffer is all stored @ DAT_00436000.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Continuing further into the function it will enter this function&hellip;Whether the parameter controlling the command has been specified via file or by prompt. We are going the file route because I am assuming it will be easier to exploit with more file I/O.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 562.50px; height: 314.60px;"><img alt="" src="images/image20.png" style="width: 562.50px; height: 314.60px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">The interesting part here is the call to FUN_00401740 - this references the contents of the provided command file&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 246.00px; height: 101.00px;"><img alt="" src="images/image25.png" style="width: 246.00px; height: 101.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Immediately we see this call to _strcpy from EBP + 52 into a local buffer of 0x198 or 403 bytes.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">My assumption at the moment is that this might provide some control over the stack via the provided command file.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">This can be tested by generating the necessary payload and then watching the stack&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 534.00px; height: 88.00px;"><img alt="" src="images/image17.png" style="width: 534.00px; height: 88.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Running the executable until the ret() from FUN_00401740 definitely proves that we have some control of EIP and afterwards&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 451.00px; height: 139.00px;"><img alt="" src="images/image9.png" style="width: 451.00px; height: 139.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">My ideas going forward now is to use stack pivoting and SEH to bypass DEP, and then ROP to execute my shellcode.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">From what I remember reading bc of the last assignment, in order for stack pivoting to work we need a buffer of memory where we can load our ROP + Shellcode and is accessible w/o causing access violations.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span>See here (stack pivoting): </span><span class="c8"><a class="c9" href="https://www.google.com/url?q=https://www.corelan.be/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/%23pivot&amp;sa=D&amp;source=editors&amp;ust=1645239555636113&amp;usg=AOvVaw2nBMPwakltv0fZHQ-Oj_yu">https://www.corelan.be/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/#pivot</a></span><span class="c2">&nbsp;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 216.00px;"><img alt="" src="images/image14.png" style="width: 624.00px; height: 216.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">To bypass this we have created a python script that will generate two files&hellip;</span></p><ul class="c1 lst-kix_ki225zhlwdkt-0 start"><li class="c0 li-bullet-0"><span class="c2">Exploit.wav &rarr; houses the actual stack pivot, rop gadgets, and payload&hellip;</span></li><li class="c0 li-bullet-0"><span class="c2">Command.txt &rarr; Kick starts the program with control of EIP&hellip;</span></li></ul><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Exploit.wav mimics the .WAV file structure - at least enough to bypass the logic shown earlier when matching file format field contents&hellip;. RIFF/WAV/fmt/data/etc&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">And Command is a txt file that contains enough padding to control EIP.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 577.50px; height: 267.99px;"><img alt="" src="images/image23.png" style="width: 577.50px; height: 267.99px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">These two blocks of code are used to compile everything at runtime - it minimizes the steps needed to showcase the exploit script.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">The steps are essentially&hellip;</span></p><ol class="c1 lst-kix_bf42l0fe1gjo-0 start" start="1"><li class="c0 li-bullet-0"><span class="c2">Generate shellcode from .ASM using NASM</span></li><li class="c0 li-bullet-0"><span class="c2">Read generated shellcode into variable as bytes</span></li><li class="c0 li-bullet-0"><span class="c2">Add preceding NOP offset byte and stack offset address @ 0x18CDECBC </span></li></ol><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 529.70px; height: 430.50px;"><img alt="" src="images/image11.png" style="width: 529.70px; height: 430.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">The rop chain used is the same one provided by !mona rop for the target binary&hellip; It didn&rsquo;t need any modifications other than a borrowed line from RPCRT4.dll for a JMP ESP.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 602.00px; height: 288.00px;"><img alt="" src="images/image4.png" style="width: 602.00px; height: 288.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Here we output the two files and can see the structure of the payloads&hellip;</span></p><p class="c3"><span class="c2"></span></p><ul class="c1 lst-kix_ywvsghwlkh3b-0 start"><li class="c6 li-bullet-0"><span class="c2">Exploit.wav &rarr; Format + Padding + ROP + NOPs + Shellcode</span></li><li class="c6 li-bullet-0"><span class="c2">Command.txt &rarr; Padding + EIP Address @ 0042661E</span></li></ul><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">What this should look like then altogether is&hellip;</span></p><ol class="c1 lst-kix_j4hdgm5oifhe-0 start" start="1"><li class="c0 li-bullet-0"><span class="c2">Wavread.exe loads the two files Exploit.wav &amp; Command.txt</span></li><li class="c0 li-bullet-0"><span class="c2">Command.txt overwrites the first buffer telling EIP to start @ 42661E</span></li><li class="c0 li-bullet-0"><span class="c2">After removing 16 bytes we are inside our file format stack pivot</span></li></ol><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 64.00px;"><img alt="" src="images/image5.png" style="width: 624.00px; height: 64.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><ol class="c1 lst-kix_j4hdgm5oifhe-1 start" start="1"><li class="c4 c11 li-bullet-0"><span class="c2">POP EAX &rarr; EAX == 0x00436030</span></li><li class="c4 c11 li-bullet-0"><span class="c2">POP EBP &rarr; EBP == 0x43434343</span></li><li class="c4 c11 li-bullet-0"><span class="c2">RETN &rarr; 0x0041FC22</span></li></ol><ol class="c1 lst-kix_j4hdgm5oifhe-2 start" start="1"><li class="c4 c7 li-bullet-0"><span class="c2">Swap EAX and ESP, then return</span></li><li class="c4 c7 li-bullet-0"><span class="c2">EAX == 00436030</span></li></ol><ol class="c1 lst-kix_j4hdgm5oifhe-0" start="4"><li class="c0 li-bullet-0"><span class="c2">We return then to the offset that holds our shellcode at 0x00436030</span></li></ol><ol class="c1 lst-kix_j4hdgm5oifhe-1 start" start="1"><li class="c4 c11 li-bullet-0"><span class="c2">Being 48 bytes from the start, this is the beginning to our ROP chain</span></li></ol><ol class="c1 lst-kix_j4hdgm5oifhe-0" start="5"><li class="c0 li-bullet-0"><span class="c2">Execute ROP chain for VirtualProtect()</span></li><li class="c0 li-bullet-0"><span class="c2">NOP Sled&hellip;</span></li><li class="c0 li-bullet-0"><span class="c2">&#x1f389; Begin executing personal shellcode</span></li></ol><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 190.67px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 190.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Some minor changes were made to the shellcode&hellip;</span></p><p class="c3"><span class="c2"></span></p><ul class="c1 lst-kix_4rxkyl6ur9yk-0 start"><li class="c0 li-bullet-0"><span class="c2">New payload is pulled from the same github repo &lsquo;scripts&rsquo;</span></li><li class="c0 li-bullet-0"><span class="c2">File drops to same location as it was ran instead of %TEMP%</span></li><li class="c0 li-bullet-0"><span class="c2">Proper exit(), no more APPCRASH errors after detonating with payload</span></li></ul><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 92.00px;"><img alt="" src="images/image21.png" style="width: 624.00px; height: 92.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">I documented it in the script - but no hashing was used for the call to exitprocess - none of the hashes generated would work and it kept breaking.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 532.50px; height: 150.26px;"><img alt="" src="images/image10.png" style="width: 532.50px; height: 150.26px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Simple WinExec instead of the Powershell/WMI call used previously&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 535.50px; height: 133.64px;"><img alt="" src="images/image22.png" style="width: 535.50px; height: 133.64px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">And then it deletes the second stage that was pulled from Github&hellip; .\not_malware.test</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">I tried messing with GetCurrentDirectoryA/GetTempPathA/GetClipboardData/VirtualAlloc/etc&hellip; but had consistent issues just getting them to correctly call&hellip; no idea why that was even happening.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">But this works and I changed it up enough to be content &macr;\_(&#12484;)_/&macr;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">The payload pulled from Github this time is created with Pyinstaller and UPX - it has some minor &ldquo;C2&rdquo; communications; meaning, it literally just sends a timestamped email lol. I thought about changing the host to Discord thinking it&rsquo;d be entertaining, but Github is easier for keeping track of things.</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 428.50px; height: 211.17px;"><img alt="" src="images/image27.png" style="width: 428.50px; height: 211.17px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">And then it was generated with&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 385.50px; height: 95.59px;"><img alt="" src="images/image3.png" style="width: 385.50px; height: 95.59px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c2">This is just a .MOV to show the entire process from beginning to finish&hellip; Hopefully it works&hellip;</span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 607.50px; height: 330.04px;"><img alt="" src="images/image24.gif" style="width: 607.50px; height: 330.04px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2"></span></p><p class="c4"><span class="c2">Files included with the report should be:</span></p><ul class="c1 lst-kix_9rpv6g36kjq6-0 start"><li class="c0 li-bullet-0"><span class="c2">micah.asm</span></li><li class="c0 li-bullet-0"><span class="c2">wavread.py</span></li><li class="c0 li-bullet-0"><span class="c2">notif.exe (if you don&rsquo;t want to or can&rsquo;t download successfully)</span></li></ul><div><p class="c16"><span>&nbsp;of </span></p></div></body></html>